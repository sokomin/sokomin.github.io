<!DOCTYPE html>
<!--
  Material Design Lite
  Copyright 2015 Google Inc. All rights reserved.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      https://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License
-->

<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=960">
    <!-- Page styles -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.min.css" />
    <link rel="stylesheet" href="../styles.css" />
    <link rel="icon" href="../design/RedStoneLogo.png" sizes="32x32" />
    <link rel="icon" href="../design/RedStoneLogo.png" sizes="192x192" />
    <link rel="apple-touch-icon-precomposed" href="../design/RedStoneLogo.png" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-133658114-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-133658114-1');
    </script>
    <script type="text/javascript" src="../design/jquery-3.4.1.min.js"></script>
    <script>
        function enter() {
            if (window.event.keyCode == 13) {
                var last_keyword = $('#search-field').val();
                window.location.href = "https://www.google.com/search?hl=ja&hq=inurl:sokomin.github.io&ie=UTF-8&oe=UTF-8&filter=0&q=" + last_keyword;
            }
        }
    </script>
    <script data-ad-client="ca-pub-2122309953813422" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <style>
        #view-source {
            position: fixed;
            display: block;
            right: 0;
            bottom: 0;
            margin-right: 40px;
            margin-bottom: 40px;
            z-index: 900;
        }
    </style>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 20px;
            line-height: 1.6;
        }

        h1,
        h2,
        h3 {
            margin-top: 0.4em;
            margin-bottom: 0.4em;
        }

        .section {
            margin-bottom: 2em;
            padding: 1em;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        label {
            font-weight: 600;
        }

        input[type="number"] {
            font-family: inherit;
            padding: 4px 6px;
            margin: 2px 0;
        }

        button {
            padding: 6px 14px;
            border-radius: 6px;
            border: 1px solid #ccc;
            cursor: pointer;
        }

        button:hover {
            background: #f3f3f3;
        }

        .row {
            margin-bottom: 0.5em;
        }

        .result-box {
            background: #f9f9ff;
            border-left: 4px solid #5566cc;
            padding: 0.6em 0.8em;
            margin-top: 0.6em;
            white-space: pre-wrap;
        }

        .error {
            color: #c00;
            font-weight: 600;
        }

        .small {
            font-size: 0.9em;
            color: #555;
        }

        code {
            background: #f5f5f5;
            padding: 2px 4px;
            border-radius: 4px;
        }
    </style>
    <script>var rswitch = true;</script>
    <!-- <script type="text/javascript" src="./js2023/phase_stone.js"></script> -->
    <!-- 忘れずに変えてね -->
</head>

<body>
    <title>古龍の祝福 シミュレータ 赤石の民衆</title>
    <meta name="description" content="レッドストーン総合攻略情報ポータルページ" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="Content-Script-Type" content="text/javascript" />
    <meta name="keywords" content="RED STONE ,レッドストーン,赤石の民衆,そこらの民衆,ＲＥＤ ＳＴＯＮＥ,レッドストーン,そこみん,赤石,攻略情報" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />

    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <a name="container"></a>
        <div class="android-header mdl-layout__header mdl-layout__header--waterfall">
            <div class="mdl-layout__header-row">
                <span class="android-title mdl-layout-title">
                    <a href="https://sokomin.github.io/index.html">
                        <img class="android-logo-image" src="../design/logo3.png" />
                    </a>
                </span>
                <!-- Add spacer, to align navigation to the right in desktop -->
                <div class="android-header-spacer mdl-layout-spacer"></div>
                <div
                    class="android-search-box mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right mdl-textfield--full-width">
                    <label class="mdl-button mdl-js-button mdl-button--icon" for="search-field">
                        <i class="material-icons">search</i>
                    </label>
                    <div class="mdl-textfield__expandable-holder">
                        <input placeholder="サイト内検索(Enterで実行)" class="mdl-textfield__input" type="text"
                            onkeypress="enter();" id="search-field" />
                    </div>
                </div>
                <!-- Navigation -->
                <div class="android-navigation-container">
                    <nav class="android-navigation mdl-navigation">
                        <a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/index.html">ホーム</a>
                        <a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/calculator.html">計算機</a>
                        <a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/history.html">赤石史</a>
                        <a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/link.html">リンク</a>
                        <a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://marshmallow-qa.com/sokoranominnsyu">お問合せ</a>
                    </nav>
                </div>
                <span class="android-mobile-title mdl-layout-title">
                    <a href="https://sokomin.github.io/index.html">
                        <img class="android-logo-image" src="../design/logo3.png" />
                    </a>
                </span>
                <button class="android-more-button mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect"
                    id="more-button">
                    <i class="material-icons">more_vert</i>
                </button>
                <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect" for="more-button">
                    <li class="mdl-menu__item"><a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/calculator.html">計算機</a></li>
                    <li class="mdl-menu__item"><a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/history.html">赤石史</a></li>
                    <li disabled class="mdl-menu__item"><a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://sokomin.github.io/link.html">リンク</a></li>
                    <li class="mdl-menu__item"><a class="mdl-navigation__link mdl-typography--text-uppercase"
                            href="https://marshmallow-qa.com/sokoranominnsyu">お問合せ</a></li>
                </ul>

            </div>
        </div>

        <div class="android-drawer mdl-layout__drawer">
            <span class="mdl-layout-title">
                <h2>メニュー</h2>
            </span>
            <nav class="mdl-navigation">
                <a class="mdl-navigation__link sokomin-layout-item" href="../item/item.html"><strong>アイテム</strong></a>
                <a class="mdl-navigation__link sokomin-layout-skill" href="../skill/skill.html"><strong>スキル</strong></a>
                <a class="mdl-navigation__link sokomin-layout-pt"
                    href="../monster/monster.html"><strong>モンスター</strong></a>
                <a class="mdl-navigation__link sokomin-layout-pt"
                    href="../secret/secret.html"><strong>ダンジョン</strong></a>
                <a class="mdl-navigation__link sokomin-layout-quest"
                    href="../quest/quest.html"><strong>クエスト</strong></a>
                <a class="mdl-navigation__link sokomin-layout-guild" href="../guild/guild.html"><strong>ギルド</strong></a>
                <a class="mdl-navigation__link sokomin-layout-friend"
                    href="../korea/korea-update.html"><strong>韓国情報</strong></a>
                <a class="mdl-navigation__link sokomin-layout-info"
                    href="../information/information.html"><strong>雑学</strong></a>
            </nav>
        </div>

        <div class="android-large-table mdl-layout__content">

            <!--main-->
            <div class="main-background mdl-typography--text-center korea-content">
                <br>
                <h1>古龍の祝福 シミュレータ</h1>
                <br>
                <img src="https://image.space.rakuten.co.jp/d/strg/ctrl/9/6175444b2c953f6d3dbc72d091ff62de6005d0af.10.9.9.3.png"
                    border=0 name="insertImg" /><br><br>
                <br>
                <a href="#5">製錬シミュレータ</a><br>
                <a href="#10">各段階に到達するまでの素材期待値（累計）</a><br>
                <a href="#15">費用シミュレーター</a><br>
                <br>
                <br>
                <h2>段階強化 期待値シミュレーター</h2>
                <p class="small">
                    CSV（<code>段階と確率.csv</code>）の A列・B列を元に、段階 1〜100 の成功確率を固定で使用します。<br>
                    B列の値は「％」のため、内部では 100 で割った確率（0〜1）として扱います。
                </p>

                <div class="section">
                    <h2>使用しているテーブル</h2>
                    <p class="small">
                        ・段階数: 100 段階（1〜100）<br>
                        ・段階 i の成功確率: CSV の「段階上昇確率（%）」を 100 で割った値
                    </p>
                </div>

                <div class="section">
                    <h2>（１）A段階から B 段階以上に強化する</h2>
                    <div class="row">
                        <label for="startA">スタート段階 A：</label>
                        <input type="number" id="startA" value="40" min="1" max="100">
                    </div>
                    <div class="row">
                        <label for="targetB">目標段階 B（以上）：</label>
                        <input type="number" id="targetB" value="60" min="1" max="100">
                    </div>
                    <button id="calcABBtn">（１）A→B 期待値を計算</button>

                    <div id="resultAB" class="result-box"></div>
                </div>

                <div class="section">
                    <h2>（２）初回入手から C 段階以上を得る</h2>
                    <p class="small">
                        初回入手段階は 1〜100 を等確率（各 1/100）とします。<br>
                        初回で既に C 段階以上を引いた場合、そのケースは<strong>強化 0 回</strong>として計算します。
                    </p>
                    <div class="row">
                        <label for="thresholdC">目標段階 C（以上）：</label>
                        <input type="number" id="thresholdC" value="70" min="1" max="100">
                    </div>
                    <button id="calcCBtn">（２）ランダム入手から C 以上 期待値を計算</button>

                    <div id="resultC" class="result-box"></div>
                </div>

                <div class="section">
                    <h2>3. 計算ロジック（概要）</h2>
                    <p class="small">
                        段階 i における「目標段階 T 以上になるまでの期待試行回数」を E<sub>i</sub> とします。<br>
                        ・i ≥ T のとき：既に目標達成なので E<sub>i</sub> = 0。<br>
                        ・i &lt; T のとき：成功確率を p<sub>i</sub> とすると
                    </p>
                    <pre class="small">
                    E<sub>i</sub> = 1 + (1 - p<sub>i</sub>) E<sub>i</sub> + p<sub>i</sub> × 平均{ E<sub>i+1</sub>, …, E<sub>N</sub> }
                    
                    ⇔  p<sub>i</sub> E<sub>i</sub> = 1 + p<sub>i</sub> × 平均
                    
                    ⇔  E<sub>i</sub> = 1 / p<sub>i</sub> + 平均{ E<sub>i+1</sub>, …, E<sub>N</sub> }
                      </pre>
                    <p class="small">
                        これを i = T-1, T-2, …, 1 の順に後ろから計算します。<br>
                        （２）の場合は、初回段階を一様ランダム 1〜N として、C 未満の段階の期待値を平均しています。
                </div>

                <div id="baseError" class="error"></div>
            </div>

            <script type="text/javascript" src="./js2023/ancient_dragon_enfoce.js"></script>
            <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
        </div>
</body>

</html>